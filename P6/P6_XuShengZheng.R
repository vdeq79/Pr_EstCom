#Autor: XuSheng Zheng

#----------------------------------------------------------------------------------
#Ejercicio propuesto
dif.eq <- function(x1,r,n){
  v <- x1
  for(i in 1:(n-1))
    v<-c(v,r*v[i]*(1-v[i]))
    
  return(v)
}

#----------------------------------------------------------------------------------
#a)
dif.eq(0.4,2,10)

#----------------------------------------------------------------------------------
#b)
v500 <- dif.eq(0.95, 2.99, 500)
plot(1:500,v500)

#----------------------------------------------------------------------------------
#c)
dif.eq2 <- function(x1,r){
  
  v <- c(x1, r*x1*(1-x1))
  i <- 2
  
  while ( abs(v[i]-v[i-1])>=0.02 ){
    v<-c(v,r*v[i]*(1-v[i]))
    i <- i+1
  }
    
  return( list(v=v, n=i-1) )
}

dif.eq2(0.95, 2.99)

